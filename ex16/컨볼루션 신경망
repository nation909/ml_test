# 컨볼루션 신경망(CNN)
컨볼루션 신경망은 입력된 이미지에서 다시 특징을 추출하기 위해 마스크(필터, 윈도 or 커널)를 도입하는 기법
EX. 아래의 이미지가 있을경우
1   0   1   0
0   1   1   0
0   0   1   1
0   0   1   0

2x2마스크를 준비함. 각 칸에는 가중치가 들어가 있고 샘플가중치임(*는 곱하기)
*1  *0
*0  *1

제일 위의 이미지에 마스크를 맨왼쪽 위칸에 적용시켜 보면
1*1   0*0   1   0
0*0   1*1   1   0
0      0    1   1
0      0    1   0

마스크가 적용된 부분에 가중치의 값을 곱해주고, 그결과를 합하면
(1*1) + (0*0) + (0*0) + (1*1) = 2가 나옴
이렇게 마스크를 다른 부분도 도입하면(총 9번 마스크를 씌어서 결과를 합침)

2번째 마스크 적용 부분
1   0*1   1*0   0
0   1*0   1*1   0
0    0     1    1
0    0     1    0

3~9번째는 모두의딥러닝 222page확인

마스크 도입하여 값 결과 정리
2   1   1
0   2   2
0   1   1

이렇게 해서 만들어진 층을 컨볼루션(합성곱)이라고 함
컨볼루션을 만들면 더욱 정교한 특징을 추출할 수 있음
이러한 마스크를 여러개 만들경우 여러개의 컨볼루션이 만들어짐
Conv2D()함수로 케라스에서 컨볼루션층을 추가하는 함수로 사용함
EX. model.add(Conv2D(32, kernel_size=(3, 3), input_shape=(28, 28, 1), activation="relu"))
32: 마스크를 몇개 적용할지 정함. 32개의 마스크적용
kernel_size: 마스크(커널)의 크기를 정함. (행, 열)형식이고 3 x 3크기의 마스크 사용
input_shape: 처음층에 입력되는 값을 정함 (행, 열, 색상 or 흑백)형식이고 입력 이미지가 색상이면3, 흑백이면 1을 지정
activation: 활성화함수를 정의

# 맥스 풀링
위에 컨볼루션층을 통해 이미지 특징을 도출했지만
결과가 여전히 크고 복잡하면 다시 축소해야함. 이과정을 풀링 or 서브 샘플링이라고 함
풀링기법중에 가장 많이 사용되는 방법이 맥스풀링으로
맥스풀링은 정해진 구역안에서 가장 큰값만 다음층으로 넘기고 나머지는 버림
EX 아래의 이미지가 있을때
1   0   1   0
0   4   2   0
0   1   6   1
0   0   1   0

맥스풀링을 2 x 2로 적용하면 2행2열로 구역을 나눔
1   0       1   0
0   4       2   0

0   1       6   1
0   0       1   0

그리고 각 구역에서 가장 큰 값을 추출함
4   2
1   6

이 과정을 거쳐 불필요한 정보를 간추림
MaxPooling2D()함수로 맥스풀링을 사용함
EX.
model.add(MaxPooling2D(pool_size=2))
pool_size: 풀링 창의 크기를 정하는 것으로, 2일 경우 전체 크기가 절반으로 줄어듬

# 드롭아웃(drop out)
노드가 많거나, 층이많다고 해서 학습이 좋아지지 않고 과적합이 생길 수 있음
딥러닝 학습은 과적합을 얼마나 효과적으로 피해가는지에 달려 있음
과적합을 효과적으로 피해가기위한 기법 중에 드롭아웃이 있음
드롭아웃은 은닉층에 배치된 노드중 일부를 임의로 꺼줌
랜덤하게 노드를 끔으로 학습데이터에 지나치게 치우쳐서 학습되는 과적합을 방지할 수 있음
케라스에서 Dropout()함수로 드롭아웃을 사용함
EX. model.add(Dropout(0.25) # 25%의 노드를 랜덤하게 드롭아웃시킴

# 플래튼(flatten)
컨볼루션 층이나 맥스풀링은 주어진 이미지를 2차원 배열인 채로 다룸
이를 1차원으로 바꿔주는 함수가 플래튼임
Flatten()함수를 사용하여 플래튼을 사용함
EX. model.add(Flatten())

EX. 전체 요약 프로세스 설명
784개의 속성을 갖고있음
-> 32개의 마스크, 3x3으로 렐루로 컨볼루션 사용
-> 64개의 마스크, 3x3으로 렐루로 컨볼루션 사용
-> 풀링창의 크기를 2(절반)로 정하고 렐루로 맥스풀링 시킴
-> 드롭아웃으로 25%의 노드를 드롭아웃시킴
-> 플래튼으로 2차원배열을 1차원으로 바꿔줌
-> 512개의 은닉층으로 활성화함수는 렐루 사용
-> 10개의 출력이고 활성화함수는 소프트맥스 사용
-> 아담으로 모델 실행환경 구성하여 실행시킴